the version with the implementation of the iterator
